---
layout:     post
title:      记一次移动硬盘掉盘后的数据拯救之旅
date:       2022-10-06
author:     王帅
catalog: true
tags:
    - diskgenius
    - chdsk
typora-root-url: ..
---

刚开始工作的时候，为了方便，买了1T西数移动硬盘做为数据存储；

才两年空间就不够了，于是又买了2T的希捷移动硬盘；新的硬盘用了快4年。

最近开发的时候发现硬盘的目录下会有路径无法访问的问题，工作时间又没空管，恰巧，前两天用M3U8-Downloader下载了几个视频的时候硬盘掉盘了（我不知道掉盘是什么意思，但我这种情况我称它为掉盘，就是硬盘不见了，只有重新插拔才能重新识别，在读某些数据的时候就会掉盘）



**这里提醒一下各位，只要在日常使用中发现有路径无法访问问题；就要立马停止硬盘写入并做全盘备份防止数据丢失！**



硬盘掉盘这个问题，我在网上并没有找到多少非常有效的处理指南；这里只写出我这一个多月来的数据拯救经历：

一开始有文章说可以用**chdsk**命令来修复硬盘,但我担心损坏数据决定先全盘备份

- 根据之前装系统接触到的工具来看我先尝试了[傲梅轻松备份](https://www.disktool.cn/backup/backup-software.html)

用了傲梅轻松备份的磁盘克隆功能，但我低估了磁盘克隆的速度；再加上傲梅轻松备份没有进度提示；所以到一半的时候我就手动停止了

- 傲梅没有明显的进展，我通过网上的[文章](https://www.disktool.cn/backup/backup-software.html)又尝试了另一款工具：[diskgenius](https://www.diskgenius.cn/)
- 我首先使用了全盘扇区复制功能，才两个小时就遇到了之前的问题：掉盘

![img](https://picx.zhimg.com/80/v2-3dbaa1399409b6e6d23ac4fae8d80392_720w.png)





根据提示我重新尝试了好几次（每次重试都没有继续，而是从0开始所以重试没有太大的用），都是掉盘的问题；我怀疑我的硬盘有坏道。

- 于是做了**坏道检测与修复**

最后花了5个小时查出来有16000+的柱面损坏(坏道检测的时候非常慢,有的一个坏块都要几分钟,这让我对扇区复制有了一个底)

![img](https://pic1.zhimg.com/80/v2-4a91decaab3f29f43a834d4221463efa_720w.png)



后面我又多次尝试扇区复制功能，分别勾选了**逆向复制**和**跳过大段扇区**都会在中途掉盘

- 根据坏道检测的结果来看，是有3大块扇区损坏的；这部分数据我也不打算弄回来了，那怎么能把剩余好的数据复制出来呢？

有没有手动控制复制哪部分扇区的功能呢？查看扇区复制报告，可以看到上面标注了起止扇区和未复制扇区

![img](https://picx.zhimg.com/80/v2-54346403b136eff59955451dd9486d3b_720w.png)





![img](https://pica.zhimg.com/80/v2-8797684c0e575583fb79cedf5b6d55fa_720w.png)





而扇区复制中也有相应的参数设置，于是我手动设置参数将大段的有效扇区复制了出来(下图只展示了一般的复制情况,实际上每段扇区都可能再次出错而需要再次手动复制)

![img](https://pic1.zhimg.com/80/v2-5e5dbf8fb17c7d5491730bdb4130d47b_720w.png)





只要扇区复制的次数够多,就可以获得几乎完好的拷贝扇区。

- 复制完后就可以在diskgenius里面看到拷贝出的扇区，但是在我的电脑里面却看不到这个驱动器，且在磁盘管理器中也看不到这个完整的磁盘（磁盘管理中只能看到凌乱的无法识别的分区，而不像diskgenius中展示的整个分区，所以这里扇区复制出的分区可能是diskgenius分区格式）

尝试给分区指定新的盘符时遇到错误：句柄无效

![img](https://pic1.zhimg.com/80/v2-76cd49ddaa6a0290e6687a9569590b0a_720w.png)





这时候我去问了，diskgenius的客服，答复是分区损坏，只能复制文件别考虑其它的办法

*假如我只能文件复制，那我还扇区复制做什么呢?*

我认为客服这里可能说的是有几分道理的，我也没有从损坏的分区中恢复出磁盘，我发现diskgenius和磁盘管理中显示的分区不同后，我就把扇区复制出的分区做了**备份分区到镜像文件**操作，备份成了**pmf**文件，然后重新格式化HD0后再从**pmf**还原出这个分区。

还原后访问硬盘还是有问题：**硬盘无法访问 参数错误**

(这里的问题我考虑好几天，我的文件明明在硬盘里面；也能复制出来使用，为什么硬盘读不到呢？)

我思考到这里猜测可能是文件还在，只是文件索引不对；这时候我尝试了一开始的**chdsk**命令（PS：一开始不这么做而现在做数据修复是因为我在扇区复制完后对完整的坏硬盘拷贝做了分区备份（diskgenius中的功能叫：**备份分区到镜像文件**），万一失败或出问题还能从镜像文件中还原分区）

**chdsk**命令删除了一些损毁的数据同时修复了文件错误，这时候再打开我的电脑就能正常访问硬盘了！！
